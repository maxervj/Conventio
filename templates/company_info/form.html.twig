{% extends 'base.html.twig' %}

{% block title %}{{ 'company_info.title'|trans }}{% endblock %}

{% block stylesheets %}
    <style>
        .required:after {
            content: " *";
            color: #ef4444;
        }
        .conditional-field {
            display: none;
        }
        .conditional-field.show {
            display: block;
        }
        .schedule-input {
            width: 3.5rem;
            text-align: center;
        }
        .time-separator {
            margin: 0 0.25rem;
            font-weight: 600;
        }
        .form-input {
            @apply w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 py-8">
        <!-- Language Selector -->
        <div class="max-w-5xl mx-auto px-4 mb-4">
            <div class="flex justify-end">
                <select id="language-select" onchange="changeLanguage(this.value)"
                        class="px-4 py-2 border border-gray-300 rounded-lg shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white">
                    <option value="fr" {{ locale == 'fr' ? 'selected' : '' }}>ðŸ‡«ðŸ‡· FranÃ§ais</option>
                    <option value="en" {{ locale == 'en' ? 'selected' : '' }}>ðŸ‡¬ðŸ‡§ English</option>
                    <option value="es" {{ locale == 'es' ? 'selected' : '' }}>ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
                    <option value="it" {{ locale == 'it' ? 'selected' : '' }}>ðŸ‡®ðŸ‡¹ Italiano</option>
                    <option value="de" {{ locale == 'de' ? 'selected' : '' }}>ðŸ‡©ðŸ‡ª Deutsch</option>
                </select>
            </div>
        </div>

        <div class="max-w-5xl mx-auto px-4">
            <!-- Header Card -->
            <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border border-gray-100">
                <div class="text-center">
                    <div class="inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-600 to-indigo-600 rounded-full mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                        </svg>
                    </div>
                    <h1 class="text-3xl font-bold text-gray-900 mb-2">{{ 'company_info.title'|trans }}</h1>
                    <p class="text-gray-600">{{ 'company_info.subtitle'|trans }}</p>
                </div>
            </div>

            {% for message in app.flashes('error') %}
                <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-6 rounded-r-lg shadow">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <svg class="h-5 w-5 text-red-400" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                            </svg>
                        </div>
                        <div class="ml-3">
                            <p class="text-sm text-red-700">{{ message|trans }}</p>
                        </div>
                    </div>
                </div>
            {% endfor %}

            {{ form_start(form, {'attr': {'class': 'space-y-8'}}) }}

            {# Organization Information #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.organization_info'|trans }}</h3>
                </div>

                <div class="grid grid-cols-1 gap-4">
                    <div>
                        {{ form_label(form.companyName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.companyName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.companyName) }}
                    </div>

                    <div>
                        {{ form_label(form.address, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.address, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.address) }}
                    </div>

                    <div>
                        {{ form_label(form.addressComplement, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.addressComplement, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.addressComplement) }}
                    </div>

                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            {{ form_label(form.postalCode, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.postalCode, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.postalCode) }}
                        </div>

                        <div class="col-span-2">
                            {{ form_label(form.city, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.city, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.city) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.country, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.country, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.country) }}
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.responsibleLastName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.responsibleLastName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.responsibleLastName) }}
                        </div>

                        <div>
                            {{ form_label(form.responsibleFirstName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.responsibleFirstName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.responsibleFirstName) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.responsibleFunction, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.responsibleFunction, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.responsibleFunction) }}
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.landlinePhone, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.landlinePhone, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.landlinePhone) }}
                            <small class="text-xs text-gray-500">{{ 'company_info.at_least_one_phone'|trans }}</small>
                        </div>

                        <div>
                            {{ form_label(form.mobilePhone, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.mobilePhone, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.mobilePhone) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.email, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.email, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        <small class="text-xs text-gray-500">{{ 'company_info.email_note'|trans }}</small>
                        {{ form_errors(form.email) }}
                    </div>

                    <div>
                        {{ form_label(form.website, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.website, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.website) }}
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.siret, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.siret, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.siret) }}
                        </div>

                        <div>
                            {{ form_label(form.insurerName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.insurerName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.insurerName) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.insurerReference, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.insurerReference, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.insurerReference) }}
                    </div>
                </div>
            </div>

            {# Internship Location #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.internship_location'|trans }}</h3>
                </div>

                <div class="grid grid-cols-1 gap-4">
                    <div>
                        {{ form_label(form.internshipAddress, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.internshipAddress, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.internshipAddress) }}
                    </div>

                    <div class="grid grid-cols-3 gap-4">
                        <div>
                            {{ form_label(form.internshipPostalCode, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.internshipPostalCode, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.internshipPostalCode) }}
                        </div>

                        <div class="col-span-2">
                            {{ form_label(form.internshipCity, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.internshipCity, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.internshipCity) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.internshipCountry, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.internshipCountry, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.internshipCountry) }}
                    </div>

                    <div>
                        {{ form_label(form.internshipPhone, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.internshipPhone, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.internshipPhone) }}
                    </div>
                </div>
            </div>

            {# Supervisor Information #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.supervisor_info'|trans }}</h3>
                </div>

                <div class="grid grid-cols-1 gap-4">
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.supervisorLastName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.supervisorLastName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.supervisorLastName) }}
                        </div>

                        <div>
                            {{ form_label(form.supervisorFirstName, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.supervisorFirstName, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.supervisorFirstName) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.supervisorFunction, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                        {{ form_widget(form.supervisorFunction, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                        {{ form_errors(form.supervisorFunction) }}
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            {{ form_label(form.supervisorPhone, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.supervisorPhone, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.supervisorPhone) }}
                        </div>

                        <div>
                            {{ form_label(form.supervisorEmail, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                            {{ form_widget(form.supervisorEmail, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition'}}) }}
                            {{ form_errors(form.supervisorEmail) }}
                        </div>
                    </div>
                </div>
            </div>

            {# Questionnaire #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-yellow-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.questionnaire'|trans }}</h3>
                </div>

                <div>
                    {{ form_label(form.hasTravel, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-2'}}) }}
                    {{ form_widget(form.hasTravel) }}
                    {{ form_errors(form.hasTravel) }}
                </div>
            </div>

            {# Cost Coverage #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.cost_coverage'|trans }}</h3>
                </div>

                <div class="space-y-4">
                    <div>
                        {{ form_label(form.coversTransportCosts, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-2'}}) }}
                        {{ form_widget(form.coversTransportCosts) }}
                        {{ form_errors(form.coversTransportCosts) }}

                        <div class="conditional-field mt-3 ml-6" id="transport-details">
                            {{ form_widget(form.transportCostsDetails, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition', 'placeholder': 'PrÃ©cisez les dÃ©tails...'}}) }}
                            {{ form_errors(form.transportCostsDetails) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.coversMealCosts, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-2'}}) }}
                        {{ form_widget(form.coversMealCosts) }}
                        {{ form_errors(form.coversMealCosts) }}

                        <div class="conditional-field mt-3 ml-6" id="meal-details">
                            {{ form_widget(form.mealCostsDetails, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition', 'placeholder': 'PrÃ©cisez les dÃ©tails...'}}) }}
                            {{ form_errors(form.mealCostsDetails) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.coversAccommodationCosts, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-2'}}) }}
                        {{ form_widget(form.coversAccommodationCosts) }}
                        {{ form_errors(form.coversAccommodationCosts) }}

                        <div class="conditional-field mt-3 ml-6" id="accommodation-details">
                            {{ form_widget(form.accommodationCostsDetails, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition', 'placeholder': 'PrÃ©cisez les dÃ©tails...'}}) }}
                            {{ form_errors(form.accommodationCostsDetails) }}
                        </div>
                    </div>

                    <div>
                        {{ form_label(form.providesGratification, null, {'label_attr': {'class': 'block text-sm font-medium text-gray-700 mb-2'}}) }}
                        {{ form_widget(form.providesGratification) }}
                        {{ form_errors(form.providesGratification) }}

                        <div class="conditional-field mt-3 ml-6" id="gratification-details">
                            {{ form_widget(form.gratificationDetails, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition', 'placeholder': 'PrÃ©cisez les dÃ©tails...'}}) }}
                            {{ form_errors(form.gratificationDetails) }}
                        </div>
                    </div>
                </div>
            </div>

            {# Work Schedule #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.work_schedule'|trans }}</h3>
                </div>

                <div class="overflow-x-auto">
                    <table class="min-w-full border border-gray-200 rounded-lg">
                        <thead>
                            <tr class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white">
                                <th class="px-4 py-3 text-left text-sm font-semibold"></th>
                                <th class="px-4 py-3 text-center text-sm font-semibold">{{ 'company_info.morning_start'|trans }}</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold">{{ 'company_info.morning_end'|trans }}</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold">{{ 'company_info.afternoon_start'|trans }}</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold">{{ 'company_info.afternoon_end'|trans }}</th>
                                <th class="px-4 py-3 text-center text-sm font-semibold">{{ 'company_info.hours'|trans }}</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            {% set days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'] %}
                            {% for day in days %}
                                <tr class="hover:bg-gray-50 transition">
                                    <td class="px-4 py-3 font-medium text-gray-900">{{ ('company_info.' ~ day)|trans }}</td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="number" name="work_schedule[{{ day }}][morning_start_h]" min="0" max="23" value="8"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                        <span class="time-separator">:</span>
                                        <input type="number" name="work_schedule[{{ day }}][morning_start_m]" min="0" max="59" value="00"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="number" name="work_schedule[{{ day }}][morning_end_h]" min="0" max="23" value="12"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                        <span class="time-separator">:</span>
                                        <input type="number" name="work_schedule[{{ day }}][morning_end_m]" min="0" max="59" value="00"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="number" name="work_schedule[{{ day }}][afternoon_start_h]" min="0" max="23" value="13"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                        <span class="time-separator">:</span>
                                        <input type="number" name="work_schedule[{{ day }}][afternoon_start_m]" min="0" max="59" value="00"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                    </td>
                                    <td class="px-4 py-3 text-center">
                                        <input type="number" name="work_schedule[{{ day }}][afternoon_end_h]" min="0" max="23" value="17"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                        <span class="time-separator">:</span>
                                        <input type="number" name="work_schedule[{{ day }}][afternoon_end_m]" min="0" max="59" value="00"
                                               class="schedule-input px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500" data-day="{{ day }}">
                                    </td>
                                    <td class="px-4 py-3 text-center font-semibold text-blue-600" id="total-{{ day }}">8:00</td>
                                </tr>
                            {% endfor %}
                            <tr class="bg-blue-50 font-semibold">
                                <td colspan="5" class="px-4 py-3 text-right text-gray-900">{{ 'company_info.weekly_total'|trans }}</td>
                                <td class="px-4 py-3 text-center text-blue-700 text-lg" id="weekly-total">40:00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            {# Planned Activities #}
            <div class="bg-white rounded-xl shadow-lg p-6 border border-gray-200">
                <div class="flex items-center mb-6 pb-4 border-b border-gray-200">
                    <div class="w-10 h-10 bg-pink-100 rounded-lg flex items-center justify-center mr-3">
                        <svg class="w-6 h-6 text-pink-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                        </svg>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900">{{ 'company_info.planned_activities'|trans }}</h3>
                </div>

                <div>
                    {{ form_label(form.plannedActivities, null, {'label_attr': {'class': 'required block text-sm font-medium text-gray-700 mb-1'}}) }}
                    {{ form_widget(form.plannedActivities, {'attr': {'class': 'w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition', 'rows': '6'}}) }}
                    {{ form_errors(form.plannedActivities) }}
                </div>
            </div>

            {# Submit Button #}
            <div class="text-center pb-8">
                <button type="submit"
                        class="inline-flex items-center px-8 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-semibold rounded-lg shadow-lg hover:from-blue-700 hover:to-indigo-700 transform hover:scale-105 transition duration-200">
                    <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                    </svg>
                    {{ 'company_info.submit'|trans }}
                </button>
            </div>

            {{ form_end(form) }}
        </div>
    </div>

    <script>
        function changeLanguage(lang) {
            const url = new URL(window.location.href);
            url.searchParams.set('lang', lang);
            window.location.href = url.toString();
        }

        // Show/hide conditional fields
        function toggleConditionalField(radioName, detailsId) {
            const radios = document.querySelectorAll(`input[name="${radioName}"]`);
            const detailsField = document.getElementById(detailsId);

            radios.forEach(radio => {
                radio.addEventListener('change', function() {
                    if (this.value === '1' && this.checked) {
                        detailsField.classList.add('show');
                    } else if (this.value === '0' && this.checked) {
                        detailsField.classList.remove('show');
                    }
                });
            });

            // Check initial state
            const checkedRadio = document.querySelector(`input[name="${radioName}"]:checked`);
            if (checkedRadio && checkedRadio.value === '1') {
                detailsField.classList.add('show');
            }
        }

        toggleConditionalField('company_info_form[coversTransportCosts]', 'transport-details');
        toggleConditionalField('company_info_form[coversMealCosts]', 'meal-details');
        toggleConditionalField('company_info_form[coversAccommodationCosts]', 'accommodation-details');
        toggleConditionalField('company_info_form[providesGratification]', 'gratification-details');

        // Calculate work hours
        function calculateDailyHours(day) {
            const inputs = document.querySelectorAll(`.schedule-input[data-day="${day}"]`);
            const values = Array.from(inputs).map(input => parseInt(input.value) || 0);

            // Calculate morning duration
            const morningStart = values[0] * 60 + values[1];
            const morningEnd = values[2] * 60 + values[3];
            const morningDuration = Math.max(0, morningEnd - morningStart);

            // Calculate afternoon duration
            const afternoonStart = values[4] * 60 + values[5];
            const afternoonEnd = values[6] * 60 + values[7];
            const afternoonDuration = Math.max(0, afternoonEnd - afternoonStart);

            // Total duration in minutes
            const totalMinutes = morningDuration + afternoonDuration;
            const hours = Math.floor(totalMinutes / 60);
            const minutes = totalMinutes % 60;

            return { hours, minutes, totalMinutes };
        }

        function updateScheduleDisplay() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday', 'sunday'];
            let weeklyTotalMinutes = 0;

            days.forEach(day => {
                const result = calculateDailyHours(day);
                document.getElementById(`total-${day}`).textContent =
                    `${result.hours}:${String(result.minutes).padStart(2, '0')}`;
                weeklyTotalMinutes += result.totalMinutes;
            });

            const weeklyHours = Math.floor(weeklyTotalMinutes / 60);
            const weeklyMinutes = weeklyTotalMinutes % 60;
            document.getElementById('weekly-total').textContent =
                `${weeklyHours}:${String(weeklyMinutes).padStart(2, '0')}`;
        }

        // Add event listeners to all schedule inputs
        document.querySelectorAll('.schedule-input').forEach(input => {
            input.addEventListener('input', updateScheduleDisplay);
            input.addEventListener('change', updateScheduleDisplay);
        });

        // Initial calculation
        updateScheduleDisplay();
    </script>
{% endblock %}
